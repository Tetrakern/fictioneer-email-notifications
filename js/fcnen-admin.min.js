function fcnen_revealTemplate(e){if(document.querySelectorAll(".fcnen-codemirror").forEach((e=>{e.closest(".fcnen-template-wrapper").classList.add("hidden")})),!e)return fcnen_templatePreview(""),void document.getElementById("fcnen-preview").classList.add("hidden");const t=document.getElementById(e);if(document.getElementById("fcnen-preview").classList.remove("hidden"),t)if(t.classList.remove("hidden"),t.querySelector(".CodeMirror")){fcnen_templatePreview(document.querySelector(".fcnen-template-wrapper:not(.hidden) .CodeMirror").CodeMirror.getValue())}else{wp.codeEditor.initialize(t.querySelector("textarea"),cm_settings);const e=document.querySelector(".fcnen-template-wrapper:not(.hidden) .CodeMirror").CodeMirror;fcnen_templatePreview(e.getValue()),e.on("change",(e=>{fcnen_templatePreview(e.doc.getValue())}))}}function fcnen_templatePreview(e,t=null){const n=document.getElementById("fcnen-preview-iframe"),r=n.contentWindow.document;Object.entries(fcnen_preview_replacements).forEach((([t,n])=>{e=e.replaceAll(t,n)})),e=e.replace(/\{\{[#/^]?[^{}]+\}\}/g,""),r.open(),r.write(e),r.close(),n.style.height=0;const c=t??Math.max(r.body.scrollHeight,r.body.offsetHeight,r.documentElement.clientHeight,r.documentElement.scrollHeight,r.documentElement.offsetHeight);n.style.height=c+"px"}document.querySelectorAll("[data-fcnen-open-modal]").forEach((e=>{e.addEventListener("click",(e=>{document.getElementById(e.currentTarget.dataset.fcnenOpenModal)?.showModal()}))})),document.querySelectorAll(".fcnen-modal").forEach((e=>{e.addEventListener("mousedown",(e=>{"dialog"===e.target.tagName.toLowerCase()&&(e.preventDefault(),e.target.close())}))})),document.querySelectorAll(".fcnen-input-wrap._file").forEach((e=>{e.querySelector('input[type="file"]').addEventListener("change",(t=>{e.querySelector(".fcnen-input-wrap__file-field").textContent=t.currentTarget.files[0].name}))})),document.addEventListener("DOMContentLoaded",(()=>{document.getElementById("fcnen-select-template")?.addEventListener("change",(e=>{fcnen_revealTemplate(e.currentTarget.value)}))}));