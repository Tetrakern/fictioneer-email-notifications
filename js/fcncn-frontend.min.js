const fcncn_modal=document.getElementById("fcncn-subscription-modal"),fcncn_url_params=Object.fromEntries(new URLSearchParams(window.location.search).entries());function fcncn_addEventListeners(){document.querySelector('[data-click-action="auth-mode"]').addEventListener("click",(()=>{fcncn_modal.querySelector('[data-target="auth-mode"]').hidden=!1,fcncn_modal.querySelector('[data-target="submit-mode"]').hidden=!0})),document.querySelector('[data-click-action="submit-mode"]').addEventListener("click",(()=>{fcncn_modal.querySelector('[data-target="auth-mode"]').hidden=!0,fcncn_modal.querySelector('[data-target="submit-mode"]').hidden=!1})),document.getElementById("fcnes-modal-submit-button").addEventListener("click",(e=>{fcncn_subscribe(e.currentTarget)}))}function fcncn_getModalForm(){if(document.getElementById("fcncn-subscription-form"))return;const e=fcncn_url_params["fcncn-email"]??document.getElementById("fcncn-modal-auth-email")?.value??0,n=fcncn_url_params["fcncn-code"]??document.getElementById("fcncn-modal-auth-code")?.value??0;fcn_ajaxPost({action:"fcncn_ajax_get_form_content",email:e,code:n}).then((e=>{e.success&&(fcncn_modal.querySelector('[data-target="fcncn-modal-loader"]').innerHTML=e.data.html)})).then((()=>{fcncn_addEventListeners()}))}function fcncn_subscribe(e){const n=e.closest("form"),c=document.getElementById("fcncn-modal-submit-email")?.value,t=document.querySelector('input[name="fcncn-scope"]:checked')?.value??"everything",a=document.getElementById("fcncn-modal-submit-code")?.value??0;if(!c)return void n.reportValidity();const o={action:"fcncn_ajax_subscribe_or_update",email:c,code:a,scope:t,nonce:e.closest(".fcncn-dialog-modal").querySelector('input[name="nonce"]')?.value??""};fcn_ajaxPost(o).then((e=>{console.log(e)}))}fcncn_modal&&document.querySelectorAll('[data-click-action*="fcncn-load-modal-form"]').forEach((e=>{e.addEventListener("click",(()=>{fcncn_getModalForm()}),{once:!0})}));